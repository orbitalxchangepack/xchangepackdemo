{"ast":null,"code":"import _toConsumableArray from\"/Users/CHLY/Downloads/xchangepack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/CHLY/Downloads/xchangepack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/CHLY/Downloads/xchangepack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/CHLY/Downloads/xchangepack/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from\"react\";import{useParams}from\"react-router-dom\";import axios from\"axios\";import List from\"@material-ui/core/List\";import ListItem from\"@material-ui/core/ListItem\";import ListItemText from\"@material-ui/core/ListItemText\";import Button from\"@material-ui/core/Button\";import{TextField}from\"@material-ui/core\";import AuthContext from\"../../Contexts/AuthContext\";export default function ShowThread(){var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),thread=_useState2[0],setThread=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),page=_useState6[0],setPage=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),hasMore=_useState8[0],setHasMore=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isReplying=_useState10[0],setIsReplying=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),replyContent=_useState12[0],setReplyContent=_useState12[1];var _useParams=useParams(),id=_useParams.id;var getPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/post/thread/\"+id,{params:{page:page}});case 2:response=_context.sent;if(response.data.length){setPosts(response.data);setPage(page+1);setHasMore(true);}else{setHasMore(false);}case 4:case\"end\":return _context.stop();}}},_callee);}));return function getPosts(){return _ref.apply(this,arguments);};}();useEffect(function(){var getThread=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(\"/api/thread/\"+id);case 2:response=_context2.sent;setThread(response.data);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function getThread(){return _ref2.apply(this,arguments);};}();getThread();getPosts();},[getPosts]);var handleReply=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var data,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:event.preventDefault();if(replyContent){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:data={userId:user._id,threadId:thread._id,content:replyContent};_context3.next=6;return axios.post(\"/api/post/create\",data);case 6:response=_context3.sent;setPosts([].concat(_toConsumableArray(posts),[response.data]));case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function handleReply(_x){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{style:{padding:\"2rem\"}},thread&&/*#__PURE__*/React.createElement(\"h1\",null,thread.title),thread&&/*#__PURE__*/React.createElement(\"p\",null,thread.content),/*#__PURE__*/React.createElement(List,null,posts.map(function(post,index){return/*#__PURE__*/React.createElement(ListItem,{key:index},/*#__PURE__*/React.createElement(ListItemText,{primary:post.content,secondary:post.createdAt}));})),/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",disabled:!hasMore,style:{marginRight:\"1rem\"},onClick:getPosts},\"Load More Posts\"),/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",onClick:function onClick(){return setIsReplying(true);}},\"Reply\"),isReplying&&/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleReply},/*#__PURE__*/React.createElement(TextField,{fullWidth:true,label:\"Content\",value:replyContent,onChange:function onChange(e){return setReplyContent(e.target.value);}}),/*#__PURE__*/React.createElement(Button,{type:\"submit\"},\"Reply\")));}","map":{"version":3,"sources":["/Users/CHLY/Downloads/xchangepack/client/src/components/Ask/Pages/Thread/ShowThread.js"],"names":["React","useState","useEffect","useContext","useParams","axios","List","ListItem","ListItemText","Button","TextField","AuthContext","ShowThread","user","thread","setThread","posts","setPosts","page","setPage","hasMore","setHasMore","isReplying","setIsReplying","replyContent","setReplyContent","id","getPosts","get","params","response","data","length","getThread","handleReply","event","preventDefault","userId","_id","threadId","content","post","padding","title","map","index","createdAt","marginRight","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport axios from \"axios\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Button from \"@material-ui/core/Button\";\nimport { TextField } from \"@material-ui/core\";\nimport AuthContext from \"../../Contexts/AuthContext\";\n\nexport default function ShowThread() {\n  const { user } = useContext(AuthContext);\n  const [thread, setThread] = useState(null);\n  const [posts, setPosts] = useState([]);\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(false);\n  const [isReplying, setIsReplying] = useState(false);\n  const [replyContent, setReplyContent] = useState(\"\");\n  const { id } = useParams();\n\n  const getPosts = async () => {\n    const response = await axios.get(\"/api/post/thread/\" + id, {\n      params: {\n        page,\n      },\n    });\n    if (response.data.length) {\n      setPosts(response.data);\n      setPage(page + 1);\n      setHasMore(true);\n    } else {\n      setHasMore(false);\n    }\n  };\n  useEffect(() => {\n    const getThread = async () => {\n      const response = await axios.get(\"/api/thread/\" + id);\n      setThread(response.data);\n    };\n    getThread();\n    getPosts();\n  }, [getPosts]);\n\n  const handleReply = async (event) => {\n    event.preventDefault();\n    if (!replyContent) return;\n    const data = {\n      userId: user._id,\n      threadId: thread._id,\n      content: replyContent,\n    };\n\n    const response = await axios.post(\"/api/post/create\", data);\n    setPosts([...posts, response.data]);\n  };\n\n  return (\n    <div style={{ padding: \"2rem\" }}>\n      {thread && <h1>{thread.title}</h1>}\n\n      {thread && <p>{thread.content}</p>}\n\n      <List>\n        {posts.map((post, index) => (\n          <ListItem key={index}>\n            <ListItemText primary={post.content} secondary={post.createdAt} />\n          </ListItem>\n        ))}\n      </List>\n\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        disabled={!hasMore}\n        style={{ marginRight: \"1rem\" }}\n        onClick={getPosts}\n      >\n        Load More Posts\n      </Button>\n\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={() => setIsReplying(true)}\n      >\n        Reply\n      </Button>\n      {isReplying && (\n        <form onSubmit={handleReply}>\n          <TextField\n            fullWidth\n            label=\"Content\"\n            value={replyContent}\n            onChange={(e) => setReplyContent(e.target.value)}\n          />\n\n          <Button type=\"submit\">Reply</Button>\n        </form>\n      )}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}